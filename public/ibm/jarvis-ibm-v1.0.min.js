"use strict";var Jarvis;(function(Jarvis){var Ibm;(function(Ibm){var Logger=function(){function e(e){this.className="",this.className=this.getFunctionName(e)}return e.prototype.getFunctionName=function(e){var n=/function (.{1,})\(/,t=n.exec(e.constructor.toString());return t&&t.length>1?t[1]:""},e.prototype.setLoggerLevel=function(e){Jarvis.Ibm.Logger.loggerLevel=e,console.log("Logger level changed! - "+Jarvis.Ibm.Logger.loggerLevel)},e.getInstance=function(e){return null==Jarvis.Ibm.Logger.logger&&(Jarvis.Ibm.Logger.logger=new Jarvis.Ibm.Logger(e)),Jarvis.Ibm.Logger.logger},e.prototype.debug=function(e){this.print(Jarvis.Ibm.Logger.LOGGER_LEVEL_DEBUG,Jarvis.Ibm.Logger.LOGGER_LEVEL_DEBUG_TITLE,e)},e.prototype.info=function(e){this.print(Jarvis.Ibm.Logger.LOGGER_LEVEL_INFO,Jarvis.Ibm.Logger.LOGGER_LEVEL_INFO_TITLE,e)},e.prototype.warn=function(e){this.print(Jarvis.Ibm.Logger.LOGGER_LEVEL_WARNING,Jarvis.Ibm.Logger.LOGGER_LEVEL_WARNING_TITLE,e)},e.prototype.error=function(e){this.print(Jarvis.Ibm.Logger.LOGGER_LEVEL_ERROR,Jarvis.Ibm.Logger.LOGGER_LEVEL_ERROR_TITLE,"["+e.code+"] "+e.name+" "+e.message)},e.prototype.print=function(e,n,t){if(e>=Jarvis.Ibm.Logger.loggerLevel){var r=new Date,a=(Jarvis.Ibm.Logger.LOGGER_LEVEL_DEBUG_TITLE,""),i=r.getFullYear()+"-"+(r.getMonth()+1)+"-"+r.getDate()+" "+r.getHours()+":"+r.getMinutes()+":"+r.getSeconds(),s=a+"["+n+"] ["+i+"] ";if(s+=this.className+" > ","string"==typeof t){s+=t;try{console.log(s)}catch(e){}}else try{console.log(t)}catch(e){}}},e.LOGGER_LEVEL_DEBUG=1e3,e.LOGGER_LEVEL_INFO=2e3,e.LOGGER_LEVEL_WARNING=3e3,e.LOGGER_LEVEL_ERROR=4e3,e.LOGGER_LEVEL_DEBUG_TITLE="DEBUG",e.LOGGER_LEVEL_INFO_TITLE="INFO",e.LOGGER_LEVEL_WARNING_TITLE="WARNING",e.LOGGER_LEVEL_ERROR_TITLE="ERROR",e.loggerLevel=3e3,e}();Ibm.Logger=Logger;var Utils=function(){function e(){this._logger=Jarvis.Ibm.Logger.getInstance(this)}return e.getInstance=function(){return null==Jarvis.Ibm.Utils.utils&&(Jarvis.Ibm.Utils.utils=new Jarvis.Ibm.Utils),Jarvis.Ibm.Utils.utils},e.prototype.getData=function(e,n,t,r){$.ajax({type:"GET",async:!0,url:e,crossDomain:!0,dataType:"json",timeout:5e3,cache:!1,data:n,success:function(e){"function"==typeof t&&t(e)},error:function(e){"function"==typeof r&&r(e)}})},e.prototype.postData=function(e,n,t,r){$.ajax({type:"POST",async:!0,url:e,crossDomain:!0,dataType:"json",timeout:5e3,cache:!1,data:n,success:function(e){"function"==typeof t&&t(e)},error:function(e){"function"==typeof r&&r(e)}})},e.prototype.getCookie=function(e){var n,t,r,a=document.cookie.split(";");for(n=0;n<a.length;n++)if(t=a[n].substr(0,a[n].indexOf("=")),r=a[n].substr(a[n].indexOf("=")+1),t=t.replace(/^\s+|\s+$/g,""),t==e)return unescape(r);return""},e.prototype.setCookie=function(e,n,t){this._logger.debug("쿠키 생성");var r=new Date;r.setDate(r.getDate()+t);var a=escape(n)+(null==t?"":"; expires="+r.toUTCString());document.cookie=e+"="+a+";domain=eduwill.net;"},e.prototype.getParameter=function(e){var n="",t=document.location.href;if(t.indexOf(e)>-1&&t.indexOf("?")>-1){var r=t.split("?");if(2==r.length)if(r[1].indexOf("&")>-1){var a=r[1].split("&");if(a.length>1){var i=a.filter(function(n){return n.indexOf(e)>-1})[0],s=i.split("=");2==s.length&&(n=s[1])}else if(1==a.length){i=a[0],s=i.split("=");2==s.length&&(n=s[1])}}else{s=r[1].split("=");2==s.length&&(n=s[1])}}return n},e}();Ibm.Utils=Utils;var BannerHandler=function(){function BannerHandler(){this._logger=Jarvis.Ibm.Logger.getInstance(this),this._utils=Jarvis.Ibm.Utils.getInstance(),this.BANNER_IDENTIFIER="data-jarvis-ibm",this.PREVIEW_IDENTIFIER="IBM_PREVIEW",this.BANNER_COOKIE_NAME="IBM_BANNER_HIDE",this.BANNER_COOKIE_VALUE="HIDE",this.MOBILE_WIDTH_LIMIT=1024,this._services=[],this.isPreview=!1}return BannerHandler.getInstance=function(){return null==Jarvis.Ibm.BannerHandler._handler&&(Jarvis.Ibm.BannerHandler._handler=new Jarvis.Ibm.BannerHandler),Jarvis.Ibm.BannerHandler._handler},BannerHandler.prototype.init=function(){Jarvis.Ibm.BannerHandler.API_DOMAIN="//jarvis-api.eduwill.net",Jarvis.Ibm.BannerHandler.PDS_DOMAIN="//pds.eduwill.net",this.setRequest(),this.getData()},BannerHandler.prototype.setEnviroment=function(){this._logger.info("Step1. 환경설정 Begin...");var e=document.location.href;e.indexOf("//l-")>-1?(this._logger.debug("Profile - local"),Jarvis.Ibm.BannerHandler.API_DOMAIN=Jarvis.Ibm.BannerHandler.API_DOMAIN.replace("//","//l-")+":8080",Jarvis.Ibm.BannerHandler.PDS_DOMAIN=Jarvis.Ibm.BannerHandler.PDS_DOMAIN.replace("//","//d-")):e.indexOf("//d-")>-1?(this._logger.debug("Profile - dev"),Jarvis.Ibm.BannerHandler.API_DOMAIN=Jarvis.Ibm.BannerHandler.API_DOMAIN.replace("//","//d-"),Jarvis.Ibm.BannerHandler.PDS_DOMAIN=Jarvis.Ibm.BannerHandler.PDS_DOMAIN.replace("//","//d-")):e.indexOf("//s-")>-1?(this._logger.debug("Profile - stage"),Jarvis.Ibm.BannerHandler.API_DOMAIN=Jarvis.Ibm.BannerHandler.API_DOMAIN.replace("//","//s-"),Jarvis.Ibm.BannerHandler.PDS_DOMAIN=Jarvis.Ibm.BannerHandler.PDS_DOMAIN.replace("//","//s-")):this._logger.debug("Profile - live"),this._logger.debug("API Domain - "+Jarvis.Ibm.BannerHandler.API_DOMAIN),this._logger.debug("PDS Domain - "+Jarvis.Ibm.BannerHandler.PDS_DOMAIN),e.indexOf(this.PREVIEW_IDENTIFIER)>-1&&(this._logger.debug("미리보기 동작 중..."),this.isPreview=!0)},BannerHandler.prototype.setRequest=function(){this._logger.info("Step2. 요청콘텐츠 확인 Begin...");var e,n=$("["+this.BANNER_IDENTIFIER+"]").length;if(n>0)if(1==n)e=$("["+this.BANNER_IDENTIFIER+"]").attr(this.BANNER_IDENTIFIER),this._services[0]={svcCd:e,hide:!1,banner:{bnrNo:0,bnrNm:"",expsrDevc:"",overImgUseYn:"",dimUseYn:"",endType:"",listExpsrType:"",uprndLocAdjst:0,leftLocAdjst:0,contents:[],html:"",expsrLoc:"",listFrontRearUseYn:"N",listPageUseYn:"N",tmpltNo:0},html:""};else for(var t=0;t<n;t++)this._services[t]={svcCd:$("["+this.BANNER_IDENTIFIER+"]:nth("+t+")").attr(this.BANNER_IDENTIFIER),hide:!1,banner:{bnrNo:0,bnrNm:"",expsrDevc:"",overImgUseYn:"",dimUseYn:"",endType:"",listExpsrType:"",uprndLocAdjst:0,leftLocAdjst:0,expsrLoc:"",listFrontRearUseYn:"N",listPageUseYn:"N",contents:[],tmpltNo:0,html:""},html:""};this._logger.debug("Request Data > "),this._logger.debug(this._services)},BannerHandler.prototype.getData=function(){this._logger.info("Step3. 데이터 조회 Begin...");for(var e=this._services,n=this._utils.getParameter(this.PREVIEW_IDENTIFIER),t=this._utils.getParameter("bnrNo"),r="",a=0;a<e.length;a++)r+=""==r?e[a].svcCd:","+e[a].svcCd;""!=r&&this._utils.getData(Jarvis.Ibm.BannerHandler.API_DOMAIN+"/ibm/v1/services",{svcCd:r,isPreview:1==this.isPreview?"Y":"N",previewSvcCd:n,previewBnrNo:t},this.success,function(e){try{console.log(e.message)}catch(e){}})},BannerHandler.prototype.success=function(e){var n=Jarvis.Ibm.Logger.getInstance(this),t=Jarvis.Ibm.BannerHandler.getInstance();n.debug(e),t.setServices(e),t.makeHtml(),t.inject(),t.action(),t.bindEvent()},BannerHandler.prototype.makeHtml=function(){function e(e){var t=Jarvis.Ibm.Utils.getInstance(),r=Jarvis.Ibm.BannerHandler.getInstance(),a=t.getCookie(r.BANNER_COOKIE_NAME+"_"+e.svcCd);if(a!=r.BANNER_COOKIE_VALUE){var i="",s="",o="",l=2==e.banner.tmpltNo?"ibm-floating":3==e.banner.tmpltNo?"ibm-toast":4==e.banner.tmpltNo?"ibm-layer":5==e.banner.tmpltNo?"ibm-band":"",c="";3==e.banner.tmpltNo&&(c="1"==e.banner.expsrLoc?"leftTop":"2"==e.banner.expsrLoc?"leftBottom":"3"==e.banner.expsrLoc?"rightTop":"4"==e.banner.expsrLoc?"rightBottom":""),i='<div id="ibmZone" class="ibm '+l+" "+c+'">',null!=e.banner&&("Y"==e.banner.dimUseYn&&(o+='<div class="ibm-dim"></div>'),s+='<div class="ibm-wrap">',s+=n(e,e.banner),s+="</div>",i+=o,i+=s,i+="</div>"),e.html=i}}function n(e,n){var r=Jarvis.Ibm.Logger.getInstance(""),a="",i="",s="",o=null==n.endType?"":n.endType;if(r.debug("endType : "+o),""!=o&&(i+='<div class="ibm-action">',o.indexOf("3")>-1&&(i+="| <a href='#' data-svc-cd='"+e.svcCd+"' data-action='hide7days' class='ibm-week-close' onclick='return false;'><span>일주일 보지 않기</span></a>"),o.indexOf("2")>-1&&(i+="| <a href='#' data-svc-cd='"+e.svcCd+"' data-action='hideOneday' class='ibm-today-close' onclick='return false;'><span>오늘 하루 보지 않기</span></a>"),o.indexOf("1")>-1&&(i+="<a href='#' data-svc-cd='"+e.svcCd+"' data-action='hide' class='ibm-close' onclick='return false;'><span>닫기</span></a>"),i+="</div>"),null!=n.contents)for(var l=0;l<n.contents.length;l++){var c=t(e,n,n.contents[l]);n.contents[l].html=c}r.debug("banner.listExpsrType : "+n.listExpsrType);var d=n.contents.length;if(s='<div class="ibm-inner">',d>=2)if("1"==n.listExpsrType){var v=Math.floor(Math.random()*d);s+=n.contents[v].html}else if("2"==n.listExpsrType)for(var I=0;I<d;I++)s+=n.contents[I].html;else if("3"==n.listExpsrType){s='<div class="ibm-inner" data-ibm-slide="true">';for(I=0;I<d;I++)s+=n.contents[I].html}else s+=n.contents[0].html;else s+=n.contents[0].html;return s+="</div>",a=s+i,a}function t(e,n,t){var r=Jarvis.Ibm.BannerHandler.getInstance(),a="",i="",s="",o="",l="",c="",d="";1==n.tmpltNo&&"3"==n.listExpsrType&&"Y"==t.overImgUseYn&&(d+="  <div style=\"background-color: #f7f7f7; background-image: url('"+Jarvis.Ibm.BannerHandler.PDS_DOMAIN+t.overImgUrl+"');\"></div>");var v="";""==d&&""!=t.leftColorCd&&""!=t.rightColorCd&&(v+='  <div style="background-color:'+t.leftColorCd+';"></div>',v+='  <div style="background-color: '+t.rightColorCd+';"></div>'),""==d&&""==v||(i='<div class="ibm-wings">',i+=d+v,i+="</div>");var I=document.body.offsetWidth,g="";g=""!=t.pcImgUrl&&""!=t.mobileImgUrl?I>r.MOBILE_WIDTH_LIMIT?t.pcImgUrl:t.mobileImgUrl:""==t.pcImgUrl?t.mobileImgUrl:t.pcImgUrl,o=1==n.tmpltNo&&"3"==n.listExpsrType&&"Y"==t.overImgUseYn?"<img src='"+Jarvis.Ibm.BannerHandler.PDS_DOMAIN+g+"' data-pc-src='"+(""!=t.pcImgUrl?Jarvis.Ibm.BannerHandler.PDS_DOMAIN+t.pcImgUrl:"")+"' data-mobile-src='"+(""!=t.mobileImgUrl?Jarvis.Ibm.BannerHandler.PDS_DOMAIN+t.mobileImgUrl:"")+"' />":"<img src='"+Jarvis.Ibm.BannerHandler.PDS_DOMAIN+g+("Y"==t.overImgUseYn?"' data-over-src='"+Jarvis.Ibm.BannerHandler.PDS_DOMAIN+t.overImgUrl:"")+"' data-pc-src='"+(""!=t.pcImgUrl?Jarvis.Ibm.BannerHandler.PDS_DOMAIN+t.pcImgUrl:"")+"' data-mobile-src='"+(""!=t.mobileImgUrl?Jarvis.Ibm.BannerHandler.PDS_DOMAIN+t.mobileImgUrl:"")+"' />","2"==t.contntType&&""!=t.vodUrl&&(l+='<div class="ibm-video">',t.vodUrl.toLowerCase().indexOf("//www.youtube.com/")>-1?l+='<iframe width="100%" height="100%" src="'+t.vodUrl+'" frameborder="0" scrolling="no" marginwidth="0" marginheight="0" allow="autoplay" allowfullscreen></iframe>':t.vodUrl.toLowerCase().indexOf("//tv.naver.com/")>-1?l+='<iframe width="100%" height="100%" src="'+t.vodUrl+'" frameborder="0" scrolling="no" marginwidth="0" marginheight="0" allow="autoplay" allowfullscreen></iframe>':t.vodUrl.toLowerCase().indexOf(".mp4")&&(l+='<video width="100%" height="100%" controls><source src="'+t.vodUrl+'" type="video/mp4"></video>'),l+="</div>");var m=t.links;if(null!=m&&m.length>0){c+='<div class="ibm-links">';for(var h=0;h<m.length;h++){var b=m[h];"1"==b.linkType?c+="<a href='"+b.linkUrl+"' title='' data-svc-cd='"+e.svcCd+"' data-bnr-no='"+n.bnrNo+"' data-callback='"+t.calbak+"' target='_self'><span class='sr-only'>링크 이동</span></a>":"2"==b.linkType?c+="<a href='"+b.linkUrl+"' title='' data-svc-cd='"+e.svcCd+"' data-bnr-no='"+n.bnrNo+"' data-callback='"+t.calbak+"' target='_blank'><span class='sr-only'>링크 새창</span></a>":"3"==b.linkType&&(c+="<a href=\"javascript:alert('"+b.linkMsg+"')\" title='' data-svc-cd='"+e.svcCd+"' data-bnr-no='"+n.bnrNo+"' data-callback='"+t.calbak+"'><span class='sr-only'>링크 메세지</span></a>")}c+="</div>"}return s+='<div class="ibm-banner">',s+=o,s+=l,s+=c,s+="</div>",a+='<div class="ibm-item">',a+=i,a+=s,a+="</div>",a}if(this._logger.info("Step4. 마크업 생성 Begin..."),null!=this._services){var r=this._services.length;if(r>0)for(var a=0;a<r;a++)void 0!==this._services[a].banner&&e(this._services[a])}},BannerHandler.prototype.inject=function(){this._logger.info("Step5. 데이터 주입 Begin...");Jarvis.Ibm.BannerHandler.getInstance();if(null!=this._services){var e=this._services.length;if(e>0){for(var n=0;n<e;n++)if(void 0!==this._services[n].banner){var t=this._services[n].html;if(this._logger.debug("데이터 주입 > "+this._services[n].svcCd+" : "+t),$("["+this.BANNER_IDENTIFIER+"="+this._services[n].svcCd+"]").html(t),"3"==this._services[n].banner.listExpsrType){var r=!!/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent);3!=this._services[n].banner.tmpltNo&&4!=this._services[n].banner.tmpltNo||$("[data-jarvis-ibm="+this._services[n].svcCd+"] div[class=ibm-wrap]").css("width",this._services[n].banner.contents[0].width+"px"),$("[data-jarvis-ibm="+this._services[n].svcCd+"] [data-ibm-slide=true]").slick({infinite:!0,autoplay:!0,autoplaySpeed:3e3,arrows:!r&&"Y"==this._services[n].banner.listFrontRearUseYn,dots:"Y"==this._services[n].banner.listPageUseYn,pauseOnHover:!0,adaptiveHeight:!0})}if(this._services[n].banner.leftLocAdjst>0){var a=parseInt($("["+this.BANNER_IDENTIFIER+"="+this._services[n].svcCd+"] > div:nth(0)").css("margin-left").replace("px","")),i=a+this._services[n].banner.leftLocAdjst;$("["+this.BANNER_IDENTIFIER+"="+this._services[n].svcCd+"] > div:nth(0)").css("margin-left",i)}if(this._services[n].banner.uprndLocAdjst>0){a=parseInt($("["+this.BANNER_IDENTIFIER+"="+this._services[n].svcCd+"] > div:nth(0)").css("margin-top").replace("px","")),i=a+this._services[n].banner.uprndLocAdjst;$("["+this.BANNER_IDENTIFIER+"="+this._services[n].svcCd+"] > div:nth(0)").css("margin-top",i)}}$("["+this.BANNER_IDENTIFIER+"] a").off("click"),$("["+this.BANNER_IDENTIFIER+"] a").on("click",this.setEvent)}}},BannerHandler.prototype.action=function(){},BannerHandler.prototype.bindEvent=function(){var e,n=Jarvis.Ibm.BannerHandler.getInstance();$(window).on("resize",function(t){var r=document.body.offsetWidth;clearTimeout(e),e=setTimeout(function(){for(var e=0;e<$("["+n.BANNER_IDENTIFIER+"] img").length;e++){var t=$("["+n.BANNER_IDENTIFIER+"] img:nth("+e+")").data("pcSrc"),a=$("["+n.BANNER_IDENTIFIER+"] img:nth("+e+")").data("mobileSrc");if(""!=t&&""!=a){n.MOBILE_WIDTH_LIMIT;$("["+n.BANNER_IDENTIFIER+"] img:nth("+e+")").attr("src",r>n.MOBILE_WIDTH_LIMIT?t:a)}}},250)});var t=$("["+n.BANNER_IDENTIFIER+"] img[data-over-src]").length;this._logger.debug("overImgUseCount : "+t),t>0&&($("["+n.BANNER_IDENTIFIER+"] img[data-over-src]").off("mouseover"),$("["+n.BANNER_IDENTIFIER+"] img[data-over-src]").on("mouseover",function(e){var t=$(e.target).data("overSrc"),r=document.body.offsetWidth;r>n.MOBILE_WIDTH_LIMIT&&$(e.target).attr("src",t)}),$("["+n.BANNER_IDENTIFIER+"] img[data-over-src]").on("mouseout",function(e){var t=$(e.target).data("pcSrc"),r=$(e.target).data("mobileSrc"),a=document.body.offsetWidth;a>n.MOBILE_WIDTH_LIMIT?$(e.target).attr("src",t):$(e.target).attr("src",r)}))},BannerHandler.prototype.setServices=function(e){this._services=e},BannerHandler.prototype.setEvent=function(){var _handler=Jarvis.Ibm.BannerHandler.getInstance(),_logger=Jarvis.Ibm.Logger.getInstance(this),action=null==$(this).data("action")?"":$(this).data("action"),svcCd=null==$(this).data("svc-cd")?"":$(this).data("svc-cd"),bnrNo=null==$(this).data("bnr-no")?"":$(this).data("bnr-no"),callback=null==$(this).data("callback")?"":$(this).data("callback");if(""!=action&&("hide7days"==action?_handler.eventHide7days(svcCd):"hideOneday"==action?_handler.eventHideOneday(svcCd):"hide"==action&&_handler.eventHide(svcCd)),""!=svcCd&&""!=bnrNo&&_handler.eventClick(svcCd,bnrNo),null!=callback&&""!=callback)try{eval(callback)}catch(e){_logger.error(e)}return!0},BannerHandler.prototype.eventClick=function(e,n){this._logger.debug("클릭 이벤트 / "+e+" / "+n),this._utils.postData(Jarvis.Ibm.BannerHandler.API_DOMAIN+"/ibm/v1/click",{svcCd:e,bnrNo:n},function(e){var n=Jarvis.Ibm.Logger.getInstance("");1==e&&n.debug("클릭이벤트 등록 성공!")},function(e){var n=Jarvis.Ibm.Logger.getInstance("");n.error(e)})},BannerHandler.prototype.eventDisplay=function(){var e=Jarvis.Ibm.BannerHandler.getInstance(),n=$("["+e.BANNER_IDENTIFIER+"]").length;n>0&&$("["+e.BANNER_IDENTIFIER+"]").each(function(e,n){})},BannerHandler.prototype.eventHide=function(e){this._logger.debug("안보기!"),this.hideService(e,0)},BannerHandler.prototype.eventHideOneday=function(e){this._logger.debug("하루안보기!"),this.hideService(e,1)},BannerHandler.prototype.eventHide7days=function(e){this._logger.debug("일주일안보기!"),this.hideService(e,7)},BannerHandler.prototype.hideService=function(e,n){Jarvis.Ibm.Logger.getInstance(this);n>0&&this._utils.setCookie(this.BANNER_COOKIE_NAME+"_"+e,this.BANNER_COOKIE_VALUE,n),$("["+this.BANNER_IDENTIFIER+"="+e+"]").hide()},BannerHandler.getServiceMode=function(){return this._serviceMode},BannerHandler.prototype.injectBanner=function(e,n){function t(e,n){console.log("수동 주입");var t=Jarvis.Ibm.BannerHandler.getInstance(),r=[];r=[{svcCd:e,hide:!1,banner:n,html:""}],console.log(r),t.setServices(r),t.makeHtml(),t.inject(),t.action(),t.bindEvent()}var r="UNCONNECTED-"+n;$("[id="+e+"]").attr(this.BANNER_IDENTIFIER,r),this._utils.getData(Jarvis.Ibm.BannerHandler.API_DOMAIN+"/ibm/v1/banner/"+n,{},function(e){t(r,e)},function(e){try{console.log(e.message)}catch(e){}})},BannerHandler.prototype.setLoggerLevel=function(e){var n=Jarvis.Ibm.Logger.getInstance(this);n.setLoggerLevel(e)},BannerHandler.API_DOMAIN="//jarvis-api.eduwill.net",BannerHandler.PDS_DOMAIN="//pds.eduwill.net",BannerHandler._serviceMode="L",BannerHandler}();Ibm.BannerHandler=BannerHandler})(Ibm=Jarvis.Ibm||(Jarvis.Ibm={}))})(Jarvis||(Jarvis={}));